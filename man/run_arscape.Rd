% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/main_wrapper.R
\name{run_arscape}
\alias{run_arscape}
\title{Run ARscape Analysis Pipeline}
\usage{
run_arscape(
  fold_change,
  beads_controls = NULL,
  bad_peptides = NULL,
  annotation_cols = c("pep_aa", "taxon_species", "taxon_genus"),
  max_iterations = 10,
  p_cutoff = 10^-4,
  score_cutoff = 2,
  min_peptides = 50,
  exclusion_method = "genus"
)
}
\arguments{
\item{fold_change}{Data frame containing peptide-level fold changes.
Must contain annotation columns (specified in \code{annotation_cols}) and sample columns.}

\item{beads_controls}{Optional data frame of beads-only controls. If provided,
peptides with fold change > 1 in these controls are excluded.
Alternatively, provide a character vector of \code{bad_peptides} to skip this calculation.}

\item{bad_peptides}{Optional character vector of peptide sequences/IDs to exclude manually.}

\item{annotation_cols}{Character vector of column names that are NOT samples.
Defaults to standard PhIP-seq annotations: \code{c("pep_aa", "taxon_species", "taxon_genus")}.}

\item{max_iterations}{Integer; maximum number of iterations for the background definition algorithm.}

\item{p_cutoff}{Numeric; -log10 p-value cutoff for defining positive hits. Default is 4 (-log10(0.0001)).}

\item{score_cutoff}{Numeric; ARscore cutoff for defining positive hits. Default is 2.}

\item{min_peptides}{Integer; minimum number of peptides required per group to calculate a score. Default is 50.}

\item{exclusion_method}{Character; method for excluding reactive peptides during iteration.
Options: "genus", "species", "group".}
}
\value{
A data frame containing the final ARscores and p-values for all samples.
}
\description{
The main wrapper function to process PhIP-Seq fold-change data and generate
Aggregate Reactivity Scores (ARscores).
}
\section{Parallelization & Progress}{

This function leverages the \code{furrr} package for parallel processing and \code{progressr}
for progress reporting.

To enable parallel execution:
\preformatted{
future::plan(future::multisession, workers = parallelly::availableCores())
}

To enable progress reporting:
\preformatted{
progressr::with_progress({
  run_arscape(...)
})
}
}

